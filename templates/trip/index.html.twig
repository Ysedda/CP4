{% extends 'base.html.twig' %}

{% block title %}
	{{ parent() }}
	| Trajets
{% endblock %}

{% block body %}
	<div class="home-banner min-vh-100">
		<div class="mb-0 d-flex justify-content-center">

			<div class="container mb-0">
				{% for category, messages in app.flashes %}
					{% for message in messages %}
						<div class="text-center w-100 alert alert-{{ category }}">
							{{ message }}
						</div>
					{% endfor %}
				{% endfor %}
				<h1 class="text-center mt-4">Trajets disponibles</h1>

				{# <a class="btn btn-lg btn-primary my-3" href="{{ path('app_trip_new') }}">Créer un trajet</a> #}
				{% if trips is not empty %}
					<div class="mt-4 w-100 d-flex justify-content-center flex-wrap">
						{% for trip in trips %}
							{% if app.user != trip.driver and trip.driver != null and trip.spots > 0 and app.user not in trip.passengers %}
								<div class="card col-12 col-lg-8 m-2">
									<div class="row g-0 flex-grow-1">
										<div class="col-md-6 d-none d-md-block">
											{# <img src="..." class="img-fluid rounded-start" alt="..."> #}
											{% set zoom = 0.08 %}
											<iframe width="100%" height="100%" src="https://www.openstreetmap.org/export/embed.html?bbox={{ trip.startLongitude + zoom }}%2C{{ trip.startLatitude + zoom }}%2C{{ trip.startLongitude - zoom }}%2C{{ trip.startLatitude - zoom }}&amp;layer=mapnik&amp;marker={{ trip.startLatitude }}%2C{{ trip.startLongitude }}"></iframe>
										</div>
										<div class="col-md-6">
											<div class="card-body d-flex flex-column justify-content-around gap-1 h-100">
												<h2 class="card-title h5">{{ trip.meetingPoint }}</h2>
												<p class="card-text">{{ trip.driver.firstname }}</p>
												<p class="card-text">{{ trip.date ? trip.date|date('Y-m-d') : '' }}</p>
												<div
													class="d-flex">
													{# {% for i in 0.. trip.spots - 1 %}
													                                        <i class="fa-solid fa-chair fa-2x text-dark"></i>
													                                        {% endfor %} #}
													{% if trip.spots > 1 %}
														<span>{{ trip.spots }}
															places</span>
													{% else %}
														<span>{{ trip.spots }}
															place</span>
													{% endif %}
												</div>
												<div class="d-flex col-12 justify-content-between gap-2">
													<a href="{{ path('app_trip_show', {('id'): trip.id }) }}" class="btn btn-dark {% if app.user is null %} w-100 {% endif %}">
													<i class="fa-solid pe-2 fa-circle-info"></i>Détails</a>
													{% if app.user %}
													{% include 'trip/_accept_trip.html.twig' %}
													{% endif %}
												</div>
											</div>
										</div>
									</div>
								</div>
							{% endif %}
						{% endfor %}

					</div>
				{% else %}
					<h2 class="text-center h4">Pas de trajets !</h2>
				{% endif %}
			</div>
		</div>
	</div>
{% endblock %}
